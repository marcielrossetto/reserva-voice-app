<!-- public/html/header.html -->
<header class="main-navbar" id="mainHeader">
  <div class="nav-wrapper">
    <!-- ESQUERDA: HAMBURGER + NOME (MOBILE) OU LOGO (DESKTOP) -->
    <div class="nav-left">
      <!-- MOBILE: Hamburger + Nome do usuário -->
      <div class="mobile-left-group d-lg-none">
        <button class="hamburger" onclick="toggleMobileMenu()">
          <i class="fas fa-bars"></i>
        </button>
        <span class="mobile-user-name" id="userNameMobile">Carregando...</span>
      </div>

      <!-- DESKTOP: Logo (clica → Home) -->
      <div
        class="logo-area d-none d-lg-flex"
        onclick="goToIndex()"
        style="cursor:pointer"
        title="Ir para Home"
      >
        <img src="" alt="Logo" id="headerLogo" class="img-fluid" />
      </div>
    </div>

    <!-- CENTRO: NAVEGAÇÃO PRINCIPAL (DROPDOWNS MODERNOS) -->
    <nav class="nav-center d-none d-lg-flex">
      <ul class="nav-links">
        <li class="nav-item-dropdown">
          <a href="javascript:void(0)" class="nav-action"
            >Início <i class="fas fa-chevron-down"></i
          ></a>
          <div class="nav-mega-menu">
            <a href="javascript:void(0)" onclick="goToIndex()"
              ><i class="fas fa-home"></i>
              <div>
                <strong>Home</strong><span>Visão geral do sistema</span>
              </div></a
            >
           
          </div>
        </li>

        <li class="nav-item-dropdown">
          <a href="javascript:void(0)" class="nav-action"
            >Reservas <i class="fas fa-chevron-down"></i
          ></a>
          <div class="nav-mega-menu">
            <a href="javascript:void(0)" onclick="openReservationModal()"
              ><i class="fas fa-plus-circle"></i>
              <div>
                <strong>Nova Reserva</strong><span>Cadastrar manualmente</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToSearch()"
              ><i class="fas fa-search"></i>
              <div>
                <strong>Pesquisa Total</strong><span>Relatórios avançados</span>
              </div></a
            >
           
          </div>
        </li>

        <li class="nav-item-dropdown">
          <a href="javascript:void(0)" class="nav-action"
            >Operação <i class="fas fa-chevron-down"></i
          ></a>
          <div class="nav-mega-menu">
            <a href="javascript:void(0)" onclick="goToQueue()"
              ><i class="fas fa-users-line"></i>
              <div>
                <strong>Fila de Espera</strong><span>Gestão de fluxo</span>
              </div></a
            >
           
          </div>
        </li>

        <li class="nav-item-dropdown" id="adminMenu" style="display: none">
          <a href="javascript:void(0)" class="nav-action"
            >Gestão <i class="fas fa-chevron-down"></i
          ></a>
          <div class="nav-mega-menu">
            <a href="javascript:void(0)" onclick="goToUsuarios()"
              ><i class="fas fa-users-cog"></i>
              <div>
                <strong>Equipe</strong><span>Usuários e Permissões</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToDashboard()"
              ><i class="fas fa-chart-line"></i>
              <div>
                <strong>Dashboard BI</strong><span>BI Inteligence</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToRelatorioFila()"
              ><i class="fas fa-clipboard-list"></i>
              <div>
                <strong>Relatório Fila</strong><span>Pessoas e Bebidas</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToConfigCardapio()"
              ><i class="fas fa-utensils"></i>
              <div>
                <strong>Config. Cardápio</strong><span>Cardápio Digital</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToConfigVoucher()"
              ><i class="fas fa-ticket-alt"></i>
              <div>
                <strong>Vouchers</strong><span>Cortesias e Promoções</span>
              </div></a
            >
            <a href="javascript:void(0)" onclick="goToConfigEmpresa()"
              ><i class="fas fa-building"></i>
              <div>
                <strong>Config. Empresa</strong><span>Logo e Capacidade</span>
              </div></a
            >
            <a href="javascript:void(0)"
              ><i class="fas fa-sliders-h"></i>
              <div>
                <strong>Configurações</strong><span>Regras de Negócio</span>
              </div></a
            >
          </div>
        </li>

        <li class="nav-item-dropdown">
          <a href="javascript:void(0)" class="nav-action"
            >Ajuda <i class="fas fa-chevron-down"></i
          ></a>
          <div class="nav-mega-menu">
            <a href="/support">
              <i class="fas fa-question-circle"></i>
              <div><strong>Suporte</strong><span>Fale conosco</span></div>
            </a>
            <!-- LINK PARA PRIVACIDADE -->
            <a href="/privacy">
              <i class="fas fa-shield-alt"></i>
              <div><strong>Privacidade</strong><span>Termos e LGPD</span></div>
            </a>
             <a href="javascript:void(0)" onclick="goToStats()">
              <i class="fas fa-chart-pie"></i>
              <div>
                <strong>Estatísticas</strong
                ><span>Relatórios de desempenho</span>
              </div>
            </a>
          </div>
        </li>
      </ul>
    </nav>

    <!-- DIREITA: PERFIL (DESKTOP ONLY) -->
    <div class="nav-right">
      <div class="user-profile d-none d-lg-flex dropdown">
        <button class="profile-trigger" id="userProfileBtn">
          <span id="userNameHeader">Usuário</span>
          <div class="avatar-icon"><i class="fas fa-user-circle"></i></div>
        </button>
        <div class="profile-menu">
          <a href="javascript:void(0)" onclick="openProfileModal()"
            ><i class="fas fa-id-badge"></i> Perfil</a
          >

          <a href="javascript:void(0)" onclick="logout()" class="text-danger"
            ><i class="fas fa-sign-out-alt"></i> Sair</a
          >
        </div>
      </div>
    </div>
  </div>
</header>

<!-- SIDEBAR MOBILE -->
<div class="mobile-drawer" id="mobileSidebar">
  <!-- HEADER FIXO: Logo + User + Fechar -->
  <div class="drawer-header">
    <div class="drawer-header-left">
      <div class="drawer-logo">
        <img src="" id="sidebarLogo" alt="Logo" />
      </div>
      <div
        class="drawer-user-info"
        onclick="
          toggleMobileMenu();
          openProfileModal();
        "
      >
        <i class="fas fa-user-circle"></i>
        <span id="drawerUserName">Usuário</span>
      </div>
    </div>
    <button class="close-drawer" onclick="toggleMobileMenu()">✕</button>
  </div>

  <!-- LINKS COM SCROLL -->
  <div class="drawer-links">
    <!-- INÍCIO -->
    <div class="drawer-section-label">Início</div>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        goToIndex();
      "
    >
      <i class="fas fa-home"></i> Home
    </a>

    <!-- RESERVAS -->
    <div class="drawer-section-label">Reservas</div>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        openReservationModal();
      "
    >
      <i class="fas fa-plus-circle"></i> Nova Reserva
    </a>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        goToSearch();
      "
    >
      <i class="fas fa-search"></i> Pesquisa Total
    </a>
   

    <!-- OPERAÇÃO -->
    <div class="drawer-section-label">Operação</div>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        goToQueue();
      "
    >
      <i class="fas fa-users-line"></i> Fila de Espera
    </a>
    

    <!-- GESTÃO (ADMIN) -->
    <div
      class="drawer-section-label drawer-admin-section"
      id="adminMenuMobile"
      style="display: none"
    >
      Gestão
    </div>
    <a
      href="javascript:void(0)"
      class="drawer-admin-link"
      onclick="
        toggleMobileMenu();
        goToUsuarios();
      "
      style="display: none"
    >
      <i class="fas fa-users-cog"></i> Equipe
    </a>
    <a
      href="javascript:void(0)"
      class="drawer-admin-link"
      onclick="
        toggleMobileMenu();
        goToDashboard();
      "
      style="display: none"
    >
      <i class="fas fa-chart-line"></i> Dashboard BI
    </a>
    <a
      href="javascript:void(0)"
      class="drawer-admin-link"
      onclick="
        toggleMobileMenu();
        goToRelatorioFila();
      "
      style="display: none"
    >
      <i class="fas fa-clipboard-list"></i> Relatório Fila
    </a>
    <a
      href="javascript:void(0)"
      class="drawer-admin-link"
      onclick="
        toggleMobileMenu();
        goToConfigCardapio();
      "
      style="display: none"
    >
      <i class="fas fa-utensils"></i> Config. Cardápio
    </a>
    <a href="javascript:void(0)" class="drawer-admin-link" onclick="toggleMobileMenu(); goToConfigVoucher();" style="display:none">
      <i class="fas fa-ticket-alt"></i> Vouchers
    </a>
    <a href="javascript:void(0)" class="drawer-admin-link" onclick="toggleMobileMenu(); goToConfigEmpresa();" style="display:none">
      <i class="fas fa-building"></i> Config. Empresa
    </a>
    <a href="javascript:void(0)" class="drawer-admin-link" onclick="toggleMobileMenu();" style="display:none">
      <i class="fas fa-sliders-h"></i> Configurações
    </a>

    <!-- AJUDA -->
    <div class="drawer-section-label">Ajuda</div>
    <a href="/support" onclick="toggleMobileMenu()">
      <i class="fas fa-question-circle"></i> Suporte
    </a>
    <a href="/privacy" onclick="toggleMobileMenu()">
      <i class="fas fa-shield-alt"></i> Privacidade
    </a>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        goToStats();
      "
    >
      <i class="fas fa-chart-pie"></i> Estatísticas
    </a>
    <hr />
    <!-- PERFIL E SAIR -->
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        openProfileModal();
      "
    >
      <i class="fas fa-id-badge"></i> Meu Perfil
    </a>
    <a
      href="javascript:void(0)"
      onclick="
        toggleMobileMenu();
        logout();
      "
      class="text-danger"
    >
      <i class="fas fa-sign-out-alt"></i> Sair do Sistema
    </a>
  </div>
</div>

<!-- MODAL PERFIL DO USUÁRIO -->
<div class="profile-modal-overlay" id="profileModalOverlay">
  <div class="profile-modal">
    <div class="profile-modal-header">
      <h3><i class="fas fa-user-circle"></i> Meu Perfil</h3>
      <button class="profile-modal-close" onclick="closeProfileModal()">
        &times;
      </button>
    </div>
    <div class="profile-modal-body">
      <div class="profile-modal-avatar">
        <i class="fas fa-user-circle"></i>
      </div>
      <div class="profile-modal-info">
        <div class="profile-field">
          <label><i class="fas fa-user"></i> Nome</label>
          <span id="profileNome">Carregando...</span>
        </div>
        <div class="profile-field">
          <label><i class="fas fa-envelope"></i> E-mail</label>
          <span id="profileEmail">Carregando...</span>
        </div>
        <div class="profile-field">
          <label><i class="fas fa-building"></i> Empresa</label>
          <span id="profileEmpresa">Carregando...</span>
        </div>
        <div class="profile-field">
          <label><i class="fas fa-shield-alt"></i> Nivel</label>
          <span id="profileNivel">Carregando...</span>
        </div>
        <div class="profile-field">
          <label><i class="fas fa-calendar-alt"></i> Membro desde</label>
          <span id="profileDesde">Carregando...</span>
        </div>
        <div class="profile-field">
          <label><i class="fas fa-clock"></i> Ultimo acesso</label>
          <span id="profileAcesso">Carregando...</span>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  :root {
    --nav-height: 70px;
    --brand-color: #6a5af9;
    --brand-dark: #3d2d43;
    --glass: rgba(255, 255, 255, 0.1);
    --shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
  }

  .main-navbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: var(--nav-height);
    background: linear-gradient(
      135deg,
      var(--brand-color) 0%,
      var(--brand-dark) 100%
    );
    z-index: 2000;
    box-shadow: var(--shadow);
    transition: transform 0.3s ease;
  }

  .nav-wrapper {
    max-width: 1400px;
    margin: 0 auto;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
  }

  /* LOGO LARGA */
  .logo-area {
    width: 160px;
    height: 45px;
    cursor: pointer;
    background: var(--glass);
    border-radius: 10px;
    padding: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .logo-area img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  /* NAVEGAÇÃO */
  .nav-links {
    list-style: none;
    display: flex;
    gap: 5px;
    margin: 0;
    padding: 0;
  }
  .nav-item-dropdown {
    position: relative;
  }
  .nav-action {
    color: white;
    text-decoration: none;
    padding: 10px 18px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    transition: 0.2s;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .nav-action:hover {
    background: var(--glass);
  }

  /* MEGA MENU / DROPDOWN */
  .nav-mega-menu {
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    min-width: 260px;
    border-radius: 12px;
    box-shadow: var(--shadow);
    padding: 10px;
    opacity: 0;
    visibility: hidden;
    transition:
      opacity 0.2s,
      visibility 0.2s;
    padding-top: 18px;
    margin-top: 0;
  }
  .nav-mega-menu::before {
    content: "";
    position: absolute;
    top: -10px;
    left: 0;
    right: 0;
    height: 18px;
  }
  .nav-item-dropdown:hover .nav-mega-menu {
    opacity: 1;
    visibility: visible;
  }

  .nav-mega-menu a {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 12px;
    text-decoration: none;
    border-radius: 8px;
    transition: 0.2s;
  }
  .nav-mega-menu a:hover {
    background: #f4f6ff;
  }
  .nav-mega-menu i {
    font-size: 18px;
    color: var(--brand-color);
    width: 25px;
    text-align: center;
  }
  .nav-mega-menu strong {
    display: block;
    font-size: 14px;
    color: #333;
  }
  .nav-mega-menu span {
    font-size: 11px;
    color: #888;
  }

  /* PERFIL */
  .user-profile {
    position: relative;
  }
  .profile-trigger {
    background: var(--glass);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    padding: 5px 15px;
    border-radius: 50px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    font-weight: 600;
  }
  .avatar-icon {
    font-size: 24px;
  }

  .profile-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: white;
    width: 180px;
    border-radius: 10px;
    box-shadow: var(--shadow);
    opacity: 0;
    visibility: hidden;
    padding: 8px;
    padding-top: 16px;
    transition:
      opacity 0.2s,
      visibility 0.2s;
  }
  .profile-menu::before {
    content: "";
    position: absolute;
    top: -10px;
    left: 0;
    right: 0;
    height: 16px;
  }
  .user-profile:hover .profile-menu {
    opacity: 1;
    visibility: visible;
  }
  .profile-menu a {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    text-decoration: none;
    color: #333;
    font-size: 14px;
    border-radius: 6px;
  }
  .profile-menu a:hover {
    background: #f4f6ff;
  }

  /* MOBILE ESPECÍFICO */
  .mobile-left-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .mobile-user-name {
    color: white;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 180px;
  }

  .hamburger {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 4px;
  }

  .mobile-drawer {
    position: fixed;
    top: 0;
    left: -100%;
    width: 300px;
    height: 100vh;
    height: 100dvh;
    background: white;
    z-index: 2100;
    transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
    display: flex;
    flex-direction: column;
  }
  .mobile-drawer.open {
    left: 0;
  }

  /* DRAWER HEADER - FIXO NO TOPO */
  .drawer-header {
    padding: 14px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid #eee;
    background: linear-gradient(
      135deg,
      var(--brand-color) 0%,
      var(--brand-dark) 100%
    );
    flex-shrink: 0;
  }
  .drawer-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 0;
  }
  .drawer-logo {
    width: 100px;
    height: 36px;
    background: var(--glass);
    border-radius: 8px;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .drawer-logo img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }
  .drawer-user-info {
    display: flex;
    align-items: center;
    gap: 6px;
    color: rgba(255, 255, 255, 0.85);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 0;
  }
  .drawer-user-info i {
    font-size: 16px;
    flex-shrink: 0;
  }
  .drawer-user-info span {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .close-drawer {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .close-drawer:hover {
    background: rgba(255, 255, 255, 0.35);
  }

  /* DRAWER LINKS - SCROLLÁVEL */
  .drawer-links {
    padding: 8px 12px 24px;
    display: flex;
    flex-direction: column;
    gap: 1px;
    overflow-y: auto;
    flex: 1;
    -webkit-overflow-scrolling: touch;
  }
  .drawer-section-label {
    font-size: 11px;
    text-transform: uppercase;
    font-weight: 700;
    color: #888;
    letter-spacing: 0.5px;
    padding: 12px 10px 4px;
    margin-top: 2px;
  }
  .drawer-section-label:first-child {
    margin-top: 0;
    padding-top: 6px;
  }
  .drawer-links a {
    padding: 10px;
    text-decoration: none;
    color: #333;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    font-weight: 500;
  }
  .drawer-links a:hover,
  .drawer-links a:active {
    background: #f4f6ff;
    color: var(--brand-color);
  }
  .drawer-links a i {
    width: 18px;
    text-align: center;
    color: var(--brand-color);
    font-size: 14px;
    flex-shrink: 0;
  }
  .drawer-links hr {
    border: none;
    border-top: 1px solid #eee;
    margin: 6px 0;
  }

  @media (max-width: 991px) {
    .main-navbar {
      height: 60px;
    }
    body {
      padding-top: 60px;
    }
  }

  /* MODAL PERFIL */
  .profile-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 3000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: 0.3s;
  }
  .profile-modal-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .profile-modal {
    background: white;
    border-radius: 16px;
    width: 420px;
    max-width: 92vw;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
    transform: translateY(20px) scale(0.95);
    transition: 0.3s;
    overflow: hidden;
  }
  .profile-modal-overlay.active .profile-modal {
    transform: translateY(0) scale(1);
  }

  .profile-modal-header {
    background: linear-gradient(
      135deg,
      var(--brand-color) 0%,
      var(--brand-dark) 100%
    );
    color: white;
    padding: 20px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .profile-modal-header h3 {
    margin: 0;
    font-size: 18px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .profile-modal-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: 0.2s;
  }
  .profile-modal-close:hover {
    background: rgba(255, 255, 255, 0.35);
  }

  .profile-modal-body {
    padding: 24px;
  }

  .profile-modal-avatar {
    text-align: center;
    margin-bottom: 20px;
    font-size: 64px;
    color: var(--brand-color);
    line-height: 1;
  }

  .profile-field {
    display: flex;
    flex-direction: column;
    padding: 10px 0;
    border-bottom: 1px solid #f0f0f0;
  }
  .profile-field:last-child {
    border-bottom: none;
  }
  .profile-field label {
    font-size: 11px;
    text-transform: uppercase;
    color: #888;
    font-weight: 600;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .profile-field span {
    font-size: 15px;
    color: #333;
    font-weight: 500;
  }
</style>
